"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[349],{202:(e,s,t)=>{t.a(e,(async(e,a)=>{try{t.d(s,{Z:()=>u});var l=t(9867),r=t(1357),n=t(9481),o=t(6885),i=t(2834),d=e([r]);r=(d.then?(await d)():d)[0];const m=(0,o.T)("user");function u(e){let{handleSubmit:s,closeModal:t,createUser:a,update:o=!1,updateData:d={}}=e;const[c,u]=(0,l.useState)([]),[x,p]=(0,l.useState)([{name:"username",label:"Username",value:""},{name:"email",label:"Email",value:""},{name:"first_name",label:"First Name",value:""},{name:"last_name",label:"Last Name",value:""},{name:"department",label:"Department",value:""},{name:"position",label:"Position",value:""},{name:"phone_no",label:"Phone No.",value:"",type:"number"},{name:"site_address",label:"Site Address",value:""},{name:"country",label:"Country",value:""},{name:"state",label:"State",value:""},{name:"suburb",label:"SubUrb",value:""},{name:"expiration_date",label:"Expiration Date",value:"",type:"date"},{name:"MFA",label:"MFA",value:"No"},{name:"role",label:"Role",value:"Guest"}]);(0,l.useEffect)((()=>{h(),console.log(o),o&&(async()=>{try{p((e=>{const s=[...e];return s.forEach((e=>{e.value=d[e.name]||""})),s}))}catch(e){console.error("Error initializing fields for update:",e)}})(),(async()=>{const e=await r.Z.get("/company/division/?company_id=".concat(null===m||void 0===m?void 0:m.company_id));console.log(e),p((s=>{var t;const a=[...s],l=s.findIndex((e=>"department"===e.name)),r=[];return e.data.forEach((e=>{r.push({value:e.id,name:e.department_name})})),console.log("owner",r),a[l].options=r,a[l].value=null===(t=r[0])||void 0===t?void 0:t.value,a}))})()}),[]);const h=async()=>{try{const e=await r.Z.get("http://13.213.6.180:8009/milestone/api/v1/user/role");console.log(e),p((s=>{const t=s.findIndex((e=>"role"===e.name)),a=[...s];a[t].options=null===e||void 0===e?void 0:e.data;return a[s.findIndex((e=>"MFA"===e.name))].options=[{name:"Yes"},{name:"No"}],a}))}catch(e){console.error("Error fetching roles:",e)}},b=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text";console.log("type",t),("number"!==t||/^[0-9]*$/.test(s))&&p((t=>{const a=t.findIndex((s=>s.name===e)),l=[...t];return l[a].value=s,l}))};return(0,i.jsx)(n.Z,{children:(0,i.jsx)("form",{onSubmit:e=>(async e=>{e.preventDefault();const s={};x.forEach((e=>{s[e.name]=e.value})),u([...c,s]);const t=x.reduce(((e,s)=>({...e,[s.name]:s.value})),{});let l;t.company_id=null===m||void 0===m?void 0:m.company_id,console.log("upodate data",m),l=o?await r.Z.put("user?id=".concat(d.id),t):await r.Z.post("user/",t),a(l)})(e),children:(0,i.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,i.jsxs)("div",{className:"flex items-end justify-center min-h-screen h-40 pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,i.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,i.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,i.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all sm:my-8 sm:align-middle w-[70vh]",children:[(0,i.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 !important",children:(0,i.jsxs)("div",{className:"border p-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Create a New User"}),x.length>0&&x.map((e=>(0,i.jsx)("div",{className:"mb-4 relative z-0",children:e.options?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("label",{htmlFor:e.name,className:"absolute text-sm text-textAccent dark:text-green-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto",children:e.label}),(0,i.jsxs)("select",{id:e.name,value:e.value,onChange:s=>b(e.name,s.target.value,e.type),className:"mt-1 p-2 border rounded w-full",required:!0,children:[(0,i.jsxs)("option",{disabled:!0,children:["Select ",e.label]},e.value),e.options.map((e=>(0,i.jsx)("option",{value:e.value,children:e.name},e.name)))]})]}):(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"relative z-0",children:[(0,i.jsx)("input",{value:e.value,onChange:s=>b(e.name,s.target.value,e.type),type:"date"===e.type?"date":"text",id:e.name,"aria-describedby":"standard_success_help",className:"block py-2.5 px-0 w-full text-sm text-textAccent bg-transparent border-0 border-b-2 border-textAccent appearance-none dark:text-white dark:border-green-500 dark:focus:border-green-500 focus:outline-none focus:ring-0 peer",placeholder:" "}),(0,i.jsx)("label",{htmlFor:e.name,className:"absolute text-sm text-textAccent dark:text-green-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto",children:e.label})]})})},e.name)))]})}),(0,i.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,i.jsx)("button",{type:"button",onClick:()=>(p((e=>{const s=[...e];return s.forEach((e=>{e.value=""})),s})),void t()),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",className:"bg-blue-500 text-white p-2 rounded",children:!0===o?"Update User":"Save User"})]})]})]})})})})}a()}catch(c){a(c)}}))},2473:(e,s,t)=>{t.d(s,{Z:()=>n});t(9867);var a=t(2653),l=t.n(a),r=t(2834);const n={DeleteModal:e=>{let{handleConfirmDelete:s,handleCloseModal:t}=e;return(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Deletion"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this item?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Confirm"}),(0,r.jsx)("button",{type:"button",onClick:t,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})},PreviewModal:e=>{let{handleDownloadFile:s,handleCloseModal:t,ext:a,path:n,file:o}=e;return(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen h-40 pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:t})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all sm:my-8 sm:align-middle w-[90vh]",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 !important",children:(0,r.jsx)(l(),{fileType:a,filePath:n})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"}),(0,r.jsx)("a",{href:"http://13.213.6.180:8009/milestone/api/v1/file/download/".concat(o),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Download"})]})]})]})})}}},1349:(e,s,t)=>{t.a(e,(async(e,a)=>{try{t.r(s),t.d(s,{default:()=>m});var l=t(9867),r=t(202),n=t(1357),o=t(6885),i=t(2473),d=t(2834),c=e([r,n]);[r,n]=c.then?(await c)():c;const m=()=>{var e;const[s,t]=(0,l.useState)([]),[a,c]=(0,l.useState)(""),[m,u]=(0,l.useState)([]),[x,p]=(0,l.useState)(!1),[h,b]=(0,l.useState)(null),[f,g]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1),[j,N]=(0,l.useState)([]),[w,k]=(0,l.useState)([]),C=()=>{p(!1),N([]),k(!1)};(0,l.useEffect)((()=>{S()}),[u]);const S=async()=>{u(!0);const e=(0,o.T)("user"),s=await n.Z.get("/user/?company_id=".concat(e.company_id));!1===s.is_success&&alert(s.message),t(s),console.log(s),u(!1)},_=()=>{g(!1),b(null),u(!1)};return(0,d.jsxs)("div",{className:"flex justify-around h-full w-full bg-secondary p-5",children:[f&&(0,d.jsx)(i.Z.DeleteModal,{handleCloseModal:_,handleConfirmDelete:async()=>{u(!0);await n.Z.delete("/user/?user_id=".concat(h));_(),S(),u(!1)}}),x&&(0,d.jsx)(r.Z,{update:w,updateData:j,createUser:e=>{u(!0),C(),S()},closeModal:C}),(0,d.jsxs)("div",{className:"border p-4 w-1/2 flex-1 overflow-scroll  rounded-md bg-primary",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Users Table"}),(0,d.jsx)("h2",{onClick:()=>{p(!0),k(!1)},className:"text-lg font-semibold mb-4 border-2 border-cyan-100 w-28 px-2 hover:bg-primary rounded-md text-center text-slate-600 cursor-pointer text-gray-200",children:"Add New"})]}),(0,d.jsxs)("table",{className:"w-full  text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[(0,d.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Username"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Email"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Name"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Department"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Position"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Phone No."}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Site Address"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Country"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"State"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"SubUrb"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"MFA"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Role"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Expiration Date"}),(0,d.jsx)("th",{scope:"col",className:"border p-2",children:"Actions"})]})}),(0,d.jsx)("tbody",{children:(null===s||void 0===s||null===(e=s.data)||void 0===e?void 0:e.length)>0&&s.data.map(((e,s)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"border p-2",children:e.username}),(0,d.jsx)("td",{className:"border p-2",children:e.email}),(0,d.jsxs)("td",{className:"border p-2",children:[e.first_name," ",e.last_name]}),(0,d.jsx)("td",{className:"border p-2",children:e.department}),(0,d.jsx)("td",{className:"border p-2",children:e.position}),(0,d.jsx)("td",{className:"border p-2",children:e.phone_no}),(0,d.jsx)("td",{className:"border p-2",children:e.site_address}),(0,d.jsx)("td",{className:"border p-2",children:e.country}),(0,d.jsx)("td",{className:"border p-2",children:e.state}),(0,d.jsx)("td",{className:"border p-2",children:e.suburb}),(0,d.jsx)("td",{className:"border p-2",children:e.MFA}),(0,d.jsx)("td",{className:"border p-2",children:e.role}),(0,d.jsx)("td",{className:"border p-2",children:e.expiration_date}),(0,d.jsxs)("td",{className:" border",children:[(0,d.jsx)("a",{onClick:()=>(e=>{p(!0),u(!0),N(e),k(!0)})(e),href:"#",className:"font-medium text-blue-600 dark:text-blue-500 hover:underline p-3",children:"Edit"}),(0,d.jsx)("a",{onClick:()=>{return s=e.id,b(s),void g(!0);var s},href:"#",className:"font-medium text-red-500 dark:text-blue-500 hover:underline p-3",children:"Delete"})]})]},s)))})]})]})]})};a()}catch(m){a(m)}}))}}]);
//# sourceMappingURL=349.74a2f244.chunk.js.map