(self.webpackChunkapp=self.webpackChunkapp||[]).push([[724],{75:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(9867),l=s(5911),r=(s(4492),s(2834));const n=e=>{let{cell:{value:t},row:{index:s},column:{id:l,maxWidth:n},updateData:o}=e;const[i,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(t),u=(0,a.useRef)(null);(0,a.useEffect)((()=>{i&&u.current&&(u.current.style.height="auto",u.current.style.height="".concat(u.current.scrollHeight,"px"))}),[i,d]);return(0,r.jsx)("textarea",{className:"w-full",ref:u,value:d,readOnly:!i,onClick:()=>{c(!0)},onBlur:()=>{c(!1),o(s,l,d)},onChange:e=>{m(e.target.value)},style:{resize:"none",overflow:"hidden"}},"cell-".concat(s,"-").concat(l))},o=e=>{let{columns:t,data:s,updateData:o,mergedCells:i}=e;const{getTableProps:c,getTableBodyProps:d,headerGroups:m,rows:u,prepareRow:h}=(0,l.useTable)({columns:t,data:s}),x=(e,t)=>i&&i.some((s=>e>=s.start.row&&e<=s.end.row&&t>=s.start.column&&t<=s.end.column));return(0,r.jsxs)("table",{id:"exportTable",...c(),style:{border:"1px solid black"},children:[(0,r.jsx)("thead",{}),(0,r.jsx)("tbody",{...d(),children:u.map(((e,t)=>(h(e),(0,a.createElement)("tr",{...e.getRowProps(),key:"row-".concat(e.id)},e.cells.map(((s,l)=>(0,a.createElement)("td",{...s.getCellProps(),style:{border:"1px solid black",backgroundColor:x(t,s.column.id)?"lightgray":"white"},key:"cell-".concat(t,"-").concat(s.column.id)},(0,r.jsx)(n,{cell:s,row:e,column:s.column,updateData:o}))))))))})]})}},8754:(e,t,s)=>{"use strict";s(9867),s(2653),s(2473),s(2834)},2473:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});s(9867);var a=s(2653),l=s.n(a),r=s(2834);const n={DeleteModal:e=>{let{handleConfirmDelete:t,handleCloseModal:s}=e;return(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Deletion"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this item?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Confirm"}),(0,r.jsx)("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})},PreviewModal:e=>{let{handleDownloadFile:t,handleCloseModal:s,ext:a,path:n,file:o}=e;return(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen h-40 pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:s})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all sm:my-8 sm:align-middle w-[90vh]",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 !important",children:(0,r.jsx)(l(),{fileType:a,filePath:n})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"}),(0,r.jsx)("a",{href:"http://13.213.6.180:8009/milestone/api/v1/file/download/".concat(o),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Download"})]})]})]})})}}},6519:(e,t,s)=>{"use strict";s.a(e,(async(e,a)=>{try{s.r(t),s.d(t,{default:()=>p});var l=s(9867),r=s(625),n=s(75),o=s(5252),i=s(8135),c=(s(3295),s(8896),s(8182)),d=s(1357),m=(s(8754),s(6885)),u=s(2834),h=e([d]);function p(){var e;const[t,s]=(0,l.useState)(null),[a,h]=(0,l.useState)(null),[x,p]=(0,l.useState)(null),[f,g]=(0,l.useState)(!1),[b,y]=(0,l.useState)(null),[v,w]=(0,l.useState)(!1);(0,l.useEffect)((()=>{j()}),[]);const j=async()=>{w(!0);const e=await d.Z.get("themeplate");y(e),w(!1)},N=e=>{const t=new ArrayBuffer(e.length),s=new Uint8Array(t);for(let a=0;a!==e.length;++a)s[a]=255&e.charCodeAt(a);return t},k=t&&t[0]?Object.keys(t[0]).map((e=>({Header:e,accessor:e}))):[],C=async(e,t)=>{const s=await d.Z.put("themeplate?id=".concat(e),{status:t});console.log(s),!0===s.is_success&&(alert(s.message),j())};return(0,u.jsx)("div",{className:"flex justify-around h-full w-full bg-secondary p-5",children:(0,u.jsxs)("div",{className:"border p-4 w-1/2 flex-1 rounded-md bg-primary",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Assessment Themeplates"}),(0,u.jsx)(c.Z,{onFileSelect:async e=>{if(e){g(!0);const t=await(0,o.f)(e);s(t.jsonData),console.log(t.jsonData),h(t.html),p(t.cellStyles)}},title:"Upload Assessment Format"})]}),t&&f&&(0,u.jsxs)("div",{className:"w-full mt-5 h-[50vh] text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 p-5 gap-2 flex flex-col overflow-y-auto overflow-x-auto scrollbar",children:[(0,u.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"New Themeplates"}),(0,u.jsx)(n.Z,{columns:k,data:t,updateData:(e,a,l)=>{const r=[...t];r[e][a]=l,s(r)}}),(0,u.jsxs)("div",{className:"flex self-end",children:[(0,u.jsx)("button",{onClick:()=>(j(),s(null),void g(!1)),type:"button",className:"text-gray-900 bg-red-500 border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700 w-[10rem] self-end",children:"Cancel"}),(0,u.jsx)("button",{onClick:()=>(async()=>{if(t){const l=i.utils.aoa_to_sheet([...t]);console.log(t);const n=t.length+1;for(let e=1;e<=n;e++)for(let t=0;t<k.length;t++){const s=i.utils.encode_cell({r:e,c:t});l[s]=l[s]||{},l[s].s=l[s].s||{},l[s].s.wrapText=!0}const o=k.map((e=>({width:25})));l["!cols"]=o,console.log(l);const c=i.utils.book_new();i.utils.book_append_sheet(c,l,"Sheet1");const u=i.write(c,{bookType:"xlsx",type:"binary"}),h=new Blob([N(u)],{type:"application/octet-stream"}),x=new FormData;x.append("file",h,"edited_data.xlsx");try{var e;const t=await r.Z.post("http://13.213.6.180:8009/milestone/api/v1/file/upload?docType=themeplate",x,{headers:{"Content-Type":"multipart/form-data"}});if(null!==(e=t.data)&&void 0!==e&&e.filename){const e=(0,m.T)("user"),a=JSON.stringify({user_id:e.id,themeplate:t.data.filename}),l=await d.Z.post("themeplate",a);console.log(l),!0===l.is_success&&(alert(l.message),s(null),g(!1),j())}console.log("File uploaded successfully",t.data)}catch(a){console.error("Error uploading file:",a)}}})(),type:"button",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700 w-[10rem] self-end",children:"Save Themeplate"})]})]}),!t&&!f&&(0,u.jsx)("div",{className:"w-full mt-5 h-[50vh] text-sm text-left rtl:text-right text-gray-500 bg-primary dark:text-gray-400 p-5 gap-2 flex flex-col overflow-y-auto overflow-x-auto scrollbar",children:(0,u.jsxs)("table",{className:"w-full  text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[(0,u.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{scope:"col",className:"border p-2",children:"Themeplate"}),(0,u.jsx)("th",{scope:"col",className:"border p-2",children:"Owner"}),(0,u.jsx)("th",{scope:"col",className:"border p-2",children:"Status"}),(0,u.jsx)("th",{scope:"col",className:"border p-2",children:"Date Created"}),(0,u.jsx)("th",{scope:"col",className:"border p-2",children:"Actions"})]})}),(0,u.jsx)("tbody",{children:(null===b||void 0===b||null===(e=b.data)||void 0===e?void 0:e.length)>0&&b.data.map(((e,t)=>(0,u.jsxs)("tr",{className:"hover:bg-secondary cursor-pointer",children:[(0,u.jsx)("td",{className:"border p-2",children:(0,u.jsx)("a",{className:"text-textPrimary hover:underline",href:"http://13.213.6.180:8009/milestone/api/v1/file/read/".concat(e.themplate,"?docType=themeplate"),children:e.themplate})}),(0,u.jsx)("td",{className:"border p-2",children:e.user_id}),(0,u.jsx)("td",{className:"border p-2",children:e.status}),(0,u.jsx)("td",{className:"border p-2",children:e.created_at}),(0,u.jsxs)("td",{className:" border",children:["Approved"===e.status&&(0,u.jsx)("a",{href:"#",className:"font-medium text-green-600 dark:text-blue-500 hover:underline p-3",children:"Send To Supplier"}),"Pending"===e.status&&(0,u.jsx)("a",{onClick:()=>C(e.id,"Approved"),href:"#",className:"font-medium text-textPrimary dark:text-blue-500 hover:underline p-3",children:"Approve"}),"Pending"===e.status&&(0,u.jsx)("a",{onClick:()=>C(e.id,"Reject"),href:"#",className:"font-medium text-textPrimary dark:text-blue-500 hover:underline p-3",children:"Reject"}),"Approved"===e.status&&(0,u.jsx)("a",{onClick:()=>C(e.id,"Disabled"),href:"#",className:"font-medium text-textPrimary dark:text-blue-500 hover:underline p-3",children:"Disabled"}),"Disabled"===e.status&&(0,u.jsx)("a",{onClick:()=>C(e.id,"Approved"),href:"#",className:"font-medium text-textPrimary dark:text-blue-500 hover:underline p-3",children:"Enable"}),(0,u.jsx)("a",{onClick:()=>(async e=>{const t=await d.Z.delete("themeplate?id=".concat(e));console.log(t),!0===t.is_success&&(alert(t.message),j())})(e.id),href:"#",className:"font-medium text-red-500 dark:text-blue-500 hover:underline p-3",children:"Delete"})]})]},t)))})]})})]})})}d=(h.then?(await h)():h)[0],a()}catch(x){a(x)}}))},8182:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s(9867),l=s(625),r=s(2834);const n=(0,a.forwardRef)(((e,t)=>{const[s,n]=(0,a.useState)(null),o=async e=>{if(s){const a=new FormData;a.append("file",s);const r={method:"post",maxBodyLength:1/0,url:"http://13.213.6.180:8009/milestone/api/v1/file/upload/".concat(e),headers:{"Content-Type":"multipart/form-data"},data:a};try{return(await l.Z.request(r)).data}catch(t){}}};return(0,a.useImperativeHandle)(t,(()=>({handleSaveClick:o}))),(0,r.jsxs)("div",{className:"flex-col gap-1 flex",children:[(0,r.jsx)("label",{children:e.title}),(0,r.jsx)("input",{type:"file",required:e.required,className:"bg-yellow-200",onChange:t=>{n(null);const s=t.target.files[0];if(s){["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(s.type)?(n(s),e.onFileSelect(s)):(alert("Please select a valid file type (PDF or DOCX)"),t.target.value=null)}}})]})}))},5252:(e,t,s)=>{"use strict";s.d(t,{f:()=>l});var a=s(8135);const l=e=>new Promise(((t,s)=>{const l=new FileReader;l.onload=e=>{const s=new Uint8Array(e.target.result),l=a.read(s,{type:"array",cellStyles:!0}),r=l.SheetNames[0],n=l.Sheets[r],o=a.utils.sheet_to_json(n,{header:1,defval:""}),i={},c=n["!merges"]||[];for(const t in n)if("!ref"!==t){const e=n[t];e&&e.s&&(i[t]=e.s);for(let s=0;s<c.length;s++){const l=c[s];if(l.s.c<=e.c&&e.c<=l.e.c&&l.s.r<=e.r&&e.r<=l.e.r)for(let e=l.s.r;e<=l.e.r;e++)for(let s=l.s.c;s<=l.e.c;s++){i[a.utils.encode_cell({r:e,c:s})]=i[t]}}}t({jsonData:o,cellStyles:i})},l.readAsArrayBuffer(e)}))},9557:()=>{},5382:()=>{},2095:()=>{},1219:()=>{}}]);
//# sourceMappingURL=724.8fba090e.chunk.js.map